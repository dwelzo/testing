

##  **1️⃣ What Is Code Coverage?**

**Code coverage** measures **how much of your code is actually executed** when your tests run.

In simple words:

> It tells you how much of your code your tests are *touching*.

---

### 🎯 Example

```ts
function greet(name?: string) {
  if (!name) return "Hello, Stranger!";
  return `Hello, ${name}!`;
}
```

✅ You write **one test:**

```ts
test("should greet user by name", () => {
  expect(greet("Mahesh")).toBe("Hello, Mahesh!");
});
```

🧪 When you run tests:

* The line `return \`Hello, ${name}!`;` executes ✅
* The line `if (!name)` never executes ❌

So your coverage is **~50%** — because **half the code** didn’t run.

---

## 🧠 **2️⃣ Why Coverage Matters**

| Reason                      | Why                                         |
| --------------------------- | ------------------------------------------- |
| 🪲 **Detect untested code** | Shows areas you forgot to test              |
| 🔍 **Increase confidence**  | If 90%+ of code is covered, fewer surprises |
| 🧱 **Safer refactoring**    | You know existing logic is guarded by tests |
| ⚙️ **Enforces discipline**  | Teams ensure consistent testing quality     |

---

## 📊 **3️⃣ Types of Coverage Metrics**

There are 4 main types of coverage metrics you’ll see in reports:

| Metric                 | What It Measures          | Example                           |
| ---------------------- | ------------------------- | --------------------------------- |
| **Line coverage**      | % of lines executed       | Did every line of code run?       |
| **Statement coverage** | % of statements executed  | `let`, `if`, `return`, etc.       |
| **Branch coverage**    | % of if/else branches run | Did both `if` and `else` execute? |
| **Function coverage**  | % of functions tested     | Did every function get called?    |

---

### 📖 Example Breakdown

```ts
function calculate(a: number, b: number) {
  if (b === 0) return "Error";
  return a / b;
}
```

| Test Case                  | Code Covered   |
| -------------------------- | -------------- |
| `calculate(10, 2)`         | ✅ main branch  |
| Missing `calculate(10, 0)` | ❌ error branch |

➡️ **Branch coverage = 50%**
Because one path (`b === 0`) never ran.

---

## 🧮 **4️⃣ How It’s Calculated**

Let’s say your file has 10 lines of code.
If your tests execute 8 lines:

```
Line Coverage = (8 / 10) × 100 = 80%
```

Same logic applies for branches and functions.

---

## 🧰 **5️⃣ In Jest (TypeScript / JavaScript)**

### Enable coverage:

```bash
npm test -- --coverage
```

or add in `package.json`:

```json
"scripts": {
  "test": "jest --coverage"
}
```

### Output Example:

```
-----------------|---------|----------|---------|---------
File             | % Stmts | % Branch | % Funcs | % Lines |
-----------------|---------|----------|---------|---------
All files        |   90.00 |    80.00 |   100.00|   90.00 |
 app.ts          |   90.00 |    80.00 |   100.00|   90.00 |
-----------------|---------|----------|---------|---------
```

* **% Stmts:** Statement coverage
* **% Branch:** Branch (if/else) coverage
* **% Funcs:** Function coverage
* **% Lines:** Line coverage

You’ll also get a **HTML report** in `/coverage/lcov-report/index.html`.

---

## 🧱 **6️⃣ Real-World Target**

| Environment              | Recommended Coverage                                                                      |
| ------------------------ | ----------------------------------------------------------------------------------------- |
| 🧑‍💻 Development        | 70–80% (good)                                                                             |
| 🏢 Production/Enterprise | 85–95% (excellent)                                                                        |
| 🚫 100%                  | Possible but not always meaningful — focus on **important logic**, not every trivial line |

---

## ⚠️ **7️⃣ Common Misunderstandings**

❌ High coverage ≠ good tests
✅ Meaningful tests = good tests

For example:

```ts
expect(true).toBe(true);
```

This gives 100% coverage but **tests nothing useful**.

So focus on **testing behavior, not just numbers**.

---

## ✅ **8️⃣ How to Improve Coverage**

1. Add tests for **error handling** (like missing inputs)
2. Cover **all branches** (`if`, `else`, `switch`)
3. Test **loop boundaries** (`0`, `1`, `many`)
4. Use coverage reports to identify **untested lines**
5. Add **negative tests** (bad inputs, nulls, exceptions)

---

## 📌 **9️⃣ Summary**
```

| Concept       | Meaning                               |
| ------------- | ------------------------------------- |
| Code Coverage | How much code your tests actually run |
| Types         | Line, Statement, Branch, Function     |
| Tool          | Jest, Istanbul                        |
| Command       | `npm test -- --coverage`              |
| Goal          | 80–90% realistic target               |
| Remember      | Quality > Quantity of tests           |

```
